{{ template "header.html" . }}

<!-- Emoji:
Pending <span style="font-size:10rem">üîß</span>
Pass <span style="font-size:10rem">‚úÖ</span>
Fail <span style="font-size:10rem">‚õî</span>
  -->

<h2>{{.Job.Id}}</h2>

<p>Status: {{.Job.Status}}</p>

{{ with .Dispatch }}
<p>Testing Farm request: <a href="https://artifacts.dev.testing-farm.io/{{.TfId}}/">{{.TfId}}</a></p>
{{ else }}
<p>There is no dispatch info for this job.</p>
{{ end }}

{{ with .Results }}

<div class="container-fluid">

  {{ range .Plans }}

  {{ $plan_emoji := "‚õî" }}
  {{ if eq .Result "passed" }}
  {{ $plan_emoji = "‚úÖ" }}
  {{ end }}

  <div class="row">
    <div class="col-sm-12">
      <div class="card">
	<div class="card-body">
	  <h3 class="card-title">{{$plan_emoji}}{{.Name}}</h3>
	  <p class="card-text">
	    Plan overall result: {{.Result}}<br/>
	  </p>
	  {{ range .Logs }}
	  <a class="card-link" href="{{.Url}}">{{.Name}}</a>
	  {{ end }}
	</div>
      </div>
    </div>
  </div>

  {{ range .Tests }}

  {{ $show := "" }}
  {{ $test_emoji := "‚õî" }}
  {{ if eq .Result "passed" }}
  {{ $test_emoji = "‚úÖ" }}
  {{ else if eq .Result "info" }}
  {{ $test_emoji = "‚ÑπÔ∏è" }}
  {{ else if eq .Result "not_applicable" }}
  {{ $test_emoji = "‚ùé" }}
  {{ else }}
  {{ $show = "show" }}
  {{ end }}

  <div class="row">
    <div class="col-sm-12">
      <button  class="btn btn-light" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{.IntId}}"	   >
	<h4>{{$test_emoji}}{{.Name}}</h4>
      </button>

      <div class="collapse {{$show}}" id="collapse{{.IntId}}">
	<div class="container-fluid">
	  <div class="row">
            <div class="col-sm-4">
	      <div class="card">
		<div class="card-body">
		  <h5 class="card-title">Test result</h5>
		  <p class="card-text">
		    Test name: {{.Name}}<br/>
		    Test result: {{.Result}}
		  </p>

		  {{ with .Link }}
		  <a class="card-link" href="{{.}}">Test sources</a>
		  {{ end }}
		  {{ range .Logs }}
		  <a class="card-link" href="{{.Url}}">{{.Name}}</a>
		  {{ end }}
		</div>
	      </div>
	    </div>

	    {{ with .Info }}

	    <div class="col-sm-8">
	      <div class="card">
		<div class="card-body">
		  <h5 class="card-title">Test metadata</h5>

		  <p class="card-text">
		    Summary: {{.Summary}}<br/>
		    Description: {{.Description}}<br/>
		    Duration: {{.Duration}}<br/>
		    Tier: {{.Tier}}<br/>

		    Contacts:
		    <ul>
		      {{ range .Contacts }}
		      <li>{{.}}</li>
		      {{ end }}
		    </ul>

		    {{ with .Tags }}
		    Tags:
		    {{ range . }}
		    <code>{{.}}</code>
		    {{ end }}
		    {{ else }}
		    No tags
		    {{ end }}
		    <br/>
		  </p>
		</div>
	      </div>
	    </div>
	    {{ end }}

	  </div>
	  {{ with .Journal }}
	  <div class="row pt-4">
	    <div class="col-sm-12">
	      <div class="card">
		<div class="card-body">
		  <h5 class="card-title">Test journal</h5>
		  <div class="embed-responsive embed-responsive-4by3">
		    <iframe class="embed-responsive-item w-100" style="height:32rem" src="{{.Url}}"></iframe>
		  </div>
		</div>
	      </div>
	    </div>
	  </div>
	  {{ end }}
	  {{ with .Testout }}
	  <div class="row pt-4">
	    <div class="col-sm-12">
	      <div class="card">
		<div class="card-body">
		  <h5 class="card-title">Test output</h5>
		  <div class="embed-responsive embed-responsive-4by3">
		    <iframe class="embed-responsive-item w-100" style="height:32rem" src="{{.Url}}"></iframe>
		  </div>
		</div>
	      </div>
	    </div>
	  </div>
	  {{ end }}

	</div>
      </div>
      {{ end }}
    </div>
  </div>
  {{ end }}
</div>

{{ else }}
<p>There are no results for this job.</p>
{{ end }}

{{ template "footer.html" . }}
